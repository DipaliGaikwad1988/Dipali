document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("signup-form"),t=document.getElementById("signin-form"),s=document.getElementById("signOut"),l=JSON.parse(localStorage.getItem("loggedInUser")),n=window.location.pathname;l&&("/signin.html"===n||"/signup.html"===n)&&(window.location.href="home.html");let i=["/home.html","/create-edit-event.html"];!l&&i.includes(n)&&(alert("You should sign in first"),window.location.href="signin.html"),e&&e.addEventListener("submit",e=>{e.preventDefault();let t=document.getElementById("first-name").value,s=document.getElementById("last-name").value,l=document.getElementById("email").value,n=document.getElementById("password").value,i=document.getElementById("confirm-password").value;if(n!==i){alert("Passwords do not match!");return}let a=JSON.parse(localStorage.getItem("users"))||[],r=a.find(e=>e.email===l);if(r){alert("User already exists!");return}let d={firstName:t,lastName:s,email:l,password:n,events:[]};a.push(d),localStorage.setItem("users",JSON.stringify(a)),alert("Sign-up successful!"),window.location.href="signin.html"}),t&&t.addEventListener("submit",e=>{e.preventDefault();let t=document.getElementById("signin-email").value,s=document.getElementById("signin-password").value,l=JSON.parse(localStorage.getItem("users"))||[],n=l.find(e=>e.email===t&&e.password===s);if(!n){alert("Invalid email or password!");return}localStorage.setItem("loggedInUser",JSON.stringify(n)),alert("Sign-in successful!"),window.location.href="home.html"}),s&&s.addEventListener("click",()=>{localStorage.removeItem("loggedInUser"),window.location.href="index.html"});let a=document.getElementById("event-form");a&&a.addEventListener("submit",e=>{e.preventDefault();let t=document.getElementById("event-title").value,s=document.getElementById("event-image").value,l={title:t,image:s},n=JSON.parse(localStorage.getItem("loggedInUser"));n.events.push(l);let i=JSON.parse(localStorage.getItem("users"))||[],a=i.findIndex(e=>e.email===n.email);i[a]=n,localStorage.setItem("users",JSON.stringify(i)),localStorage.setItem("loggedInUser",JSON.stringify(n)),alert("Event created successfully!"),window.location.href="home.html"});let r=localStorage.getItem("loggedInUser");if(r&&"/home.html"===n){let d=JSON.parse(r),m=document.getElementById("event-list");m&&d.events.forEach(e=>{let t=document.createElement("div");t.classList.add("event-card","col-12","mb-2","px-5"),t.innerHTML=`
                    <h3>${e.title}</h3>
                    <img src="${e.image}" alt="${e.title}" style="width: 100%; height: auto;">
                `,m.appendChild(t)})}let g=document.querySelectorAll("[id^=toggle-password]");g.forEach(e=>{e.addEventListener("click",()=>{let t=e.id.replace("toggle-","");togglePasswordVisibility(t)})})});function togglePasswordVisibility(e){let t=document.getElementById(e),s=document.getElementById(`toggle-${e}`);"password"===t.type?(t.type="text",s.innerHTML='<i class="fas fa-eye-slash"></i>'):(t.type="password",s.innerHTML='<i class="fas fa-eye"></i>')}